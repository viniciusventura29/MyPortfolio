---
import Layout from "../../layouts/MainLayout.astro";
import { getCollection } from "astro:content";
import { useTranslations, languages, type Locale } from "../../i18n/utils";

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

const lang = Astro.params.lang as Locale;
const t = useTranslations(lang);

const posts = await getCollection("blog");
// Filter posts by language folder (en/ or pt/)
const langPosts = posts.filter((post) => post.slug.startsWith(`${lang}/`));
const recentPosts = langPosts
  .filter((post) => post.data.draft !== true)
  .sort((a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime())
  .slice(0, 3);

// Helper to get slug without language prefix
function getPostSlug(fullSlug: string): string {
  return fullSlug.replace(`${lang}/`, '');
}
---

<Layout title="Vinicius Ventura" lang={lang}>
  <main class="main-content">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-img"></div>
      
      <h1 class="hero-name">Vinicius Ventura</h1>
      <p class="hero-role">{t.hero.role}</p>
      
      <div class="social-links">
        <a href="https://github.com/viniciusventura29" target="_blank" class="social-link" aria-label="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"/>
          </svg>
        </a>
        <a href="https://www.linkedin.com/in/vini-ventura29/" target="_blank" class="social-link" aria-label="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <rect x="4" y="4" width="16" height="16" rx="2"/>
            <line x1="8" y1="11" x2="8" y2="16"/>
            <line x1="8" y1="8" x2="8" y2="8.01"/>
            <line x1="12" y1="16" x2="12" y2="11"/>
            <path d="M16 16v-3a2 2 0 0 0 -4 0"/>
          </svg>
        </a>
        <a href="mailto:ViniciusVentura29@gmail.com" class="social-link" aria-label="Email">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"/>
            <path d="M3 7l9 6l9 -6"/>
          </svg>
        </a>
      </div>
    </section>

    <!-- About Section -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">{t.sections.about.number}</span>
        <h2 class="section-title">{t.sections.about.title}</h2>
        <span class="section-line"></span>
      </div>
      
      <div class="section-content">
        {t.sections.about.content.map((paragraph) => (
          <p set:html={paragraph} />
        ))}
      </div>
    </section>

    <!-- Blog Section -->
    <section class="section">
      <div class="section-header">
        <span class="section-number">{t.sections.blog.number}</span>
        <h2 class="section-title">{t.sections.blog.title}</h2>
        <span class="section-line"></span>
        <a href={`/${lang}/blog`} class="section-link">{t.sections.blog.viewAll}</a>
      </div>
      
      <div class="blog-list">
        {recentPosts.map((post, index) => (
          <a href={`/${lang}/blog/${getPostSlug(post.slug)}`} class="blog-entry">
            <div class="entry-header">
              <span class="entry-number">{t.sections.blog.entry} {String(index + 1).padStart(3, '0')}</span>
              <span class="entry-date">{post.data.publishDate}</span>
            </div>
            <h3 class="entry-title">{post.data.title}</h3>
            <p class="entry-description">{post.data.description}</p>
            <div class="entry-footer">
              <span class="entry-time">{post.data.time} {t.sections.blog.minRead}</span>
              <span class="entry-action">{t.sections.blog.open}</span>
            </div>
          </a>
        ))}
      </div>
    </section>

  </main>
</Layout>

<style>
  .main-content {
    padding-top: 2rem;
  }

  /* Hero Section */
  .hero-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    margin-bottom: 4rem;
  }

  .hero-img {
    width: 180px;
    height: 180px;
    background-image: url("/foto.jpg");
    background-size: cover;
    background-position: center;
    margin-bottom: 1.5rem;
    animation:
      blobMorph 12s ease-in-out infinite,
      glowPulse 3s ease-in-out infinite alternate;
  }

  @keyframes blobMorph {
    0% {
      border-radius: 65% 35% 39% 61% / 57% 38% 62% 43%;
    }
    50% {
      border-radius: 27% 73% 64% 36% / 34% 53% 47% 66%;
    }
    100% {
      border-radius: 65% 35% 39% 61% / 57% 38% 62% 43%;
    }
  }

  @keyframes glowPulse {
    from {
      box-shadow:
        0 0 20px rgba(13, 92, 75, 0.2),
        0 -5px 0 #0A4A3C,
        0 5px 0 #1A7D68;
    }
    to {
      box-shadow:
        0 0 40px rgba(13, 92, 75, 0.4),
        0 5px 0 #1A7D68,
        0 -5px 0 #0A4A3C;
    }
  }

  .hero-name {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 2rem;
    font-weight: 500;
    color: #0D5C4B;
    letter-spacing: 0.05em;
    margin: 0 0 0.25rem 0;
    text-transform: none;
  }

  .hero-role {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.9rem;
    color: #5A5A5A;
    letter-spacing: 0.1em;
    margin: 0 0 1.5rem 0;
  }

  .social-links {
    display: flex;
    gap: 0.75rem;
  }

  .social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border: 1px solid #2D3D3F;
    color: #5A5A5A;
    transition: all 0.2s ease;
  }

  .social-link:hover {
    background: #0D5C4B;
    border-color: #0D5C4B;
    color: #E8E4DE;
    transform: translateY(-2px);
  }

  @media (max-width: 768px) {
    .hero-img {
      width: 150px;
      height: 150px;
    }

    .hero-name {
      font-size: 1.5rem;
    }
  }

  /* Sections */
  .section {
    margin-bottom: 3.5rem;
  }

  .section-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .section-number {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.7rem;
    color: #0D5C4B;
    letter-spacing: 0.1em;
  }

  .section-title {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 1rem;
    font-weight: 500;
    color: #1A1A1A;
    letter-spacing: 0.15em;
    margin: 0;
    text-transform: uppercase;
  }

  .section-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(to right, #2D3D3F, transparent);
  }

  .section-link {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.65rem;
    color: #0D5C4B;
    letter-spacing: 0.1em;
    text-decoration: none;
    transition: opacity 0.2s ease;
  }

  .section-link:hover {
    opacity: 0.7;
  }

  .section-content :global(p) {
    margin-bottom: 1rem;
  }

  .section-content :global(strong) {
    color: #0D5C4B;
    font-weight: 500;
  }

  .section-content :global(a) {
    color: #0D5C4B;
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  /* Blog Entries */
  .blog-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .blog-entry {
    display: block;
    padding: 1rem;
    border: 1px solid #2D3D3F;
    background: #F5F2ED;
    text-decoration: none;
    transition: all 0.2s ease;
  }

  .blog-entry:hover {
    background: rgba(13, 92, 75, 0.05);
    border-color: #0D5C4B;
  }

  .entry-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.75rem;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.6rem;
    color: #5A5A5A;
    letter-spacing: 0.15em;
  }

  .entry-title {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.95rem;
    font-weight: 500;
    color: #1A1A1A;
    letter-spacing: 0.05em;
    margin: 0 0 0.5rem 0;
    text-transform: uppercase;
  }

  .entry-description {
    font-size: 0.85rem;
    color: #5A5A5A;
    line-height: 1.5;
    margin: 0 0 0.75rem 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .entry-footer {
    display: flex;
    justify-content: space-between;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.6rem;
    letter-spacing: 0.1em;
  }

  .entry-time {
    color: #5A5A5A;
  }

  .entry-action {
    color: #0D5C4B;
  }

  @media (max-width: 768px) {
    .section-header {
      flex-wrap: wrap;
    }

    .section-line {
      order: 10;
      flex-basis: 100%;
    }
  }
</style>
